
%% Beginning of file 'sample63.tex'
%%
%% Modified 2019 June
%%
%% This is a sample manuscript marked up using the
%% AASTeX v6.3 LaTeX 2e macros.
%%
%% AASTeX is now based on Alexey Vikhlinin's emulateapj.cls 
%% (Copyright 2000-2015).  See the classfile for details.

%% AASTeX requires revtex4-1.cls (http://publish.aps.org/revtex4/) and
%% other external packages (latexsym, graphicx, amssymb, longtable, and epsf).
%% All of these external packages should already be present in the modern TeX 
%% distributions.  If not they can also be obtained at www.ctan.org.

%% The first piece of markup in an AASTeX v6.x document is the \documentclass
%% command. LaTeX will ignore any data that comes before this command. The 
%% documentclass can take an optional argument to modify the output style.
%% The command below calls the preprint style which will produce a tightly 
%% typeset, one-column, single-spaced document.  It is the default and thus
%% does not need to be explicitly stated.
%%
%%
%% using aastex version 6.3
\documentclass[twocolumn]{./aastex63}

\usepackage{amsmath}
\usepackage{empheq}
\usepackage{mathrsfs}
\usepackage{textcomp}
\usepackage{enumitem}   
\usepackage{gensymb}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage[caption=false]{subfig}
\usepackage{multirow}
\usepackage{longtable}
\hypersetup{colorlinks, linkcolor={blue}, citecolor={blue}, urlcolor={blue}} 
%% The default is a single spaced, 10 point font, single spaced article.
%% There are 5 other style options available via an optional argument. They
%% can be invoked like this:
%%
%% \documentclass[arguments]{aastex63}
%% 
%% where the layout options are:
%%
%%  twocolumn   : two text columns, 10 point font, single spaced article.
%%                This is the most compact and represent the final published
%%                derived PDF copy of the accepted manuscript from the publisher
%%  manuscript  : one text column, 12 point font, double spaced article.
%%  preprint    : one text column, 12 point font, single spaced article.  
%%  preprint2   : two text columns, 12 point font, single spaced article.
%%  modern      : a stylish, single text column, 12 point font, article with
%% 		  wider left and right margins. This uses the Daniel
%% 		  Foreman-Mackey and David Hogg design.
%%  RNAAS       : Preferred style for Research Notes which are by design 
%%                lacking an abstract and brief. DO NOT use \begin{abstract}
%%                and \end{abstract} with this style.
%%
%% Note that you can submit to the AAS Journals in any of these 6 styles.
%%
%% There are other optional arguments one can invoke to allow other stylistic
%% actions. The available options are:
%%
%%   astrosymb    : Loads Astrosymb font and define \astrocommands. 
%%   tighten      : Makes baselineskip slightly smaller, only works with 
%%                  the twocolumn substyle.
%%   times        : uses times font instead of the default
%%   linenumbers  : turn on lineno package.
%%   trackchanges : required to see the revision mark up and print its output
%%   longauthor   : Do not use the more compressed footnote style (default) for 
%%                  the author/collaboration/affiliations. Instead print all
%%                  affiliation information after each name. Creates a much 
%%                  longer author list but may be desirable for short 
%%                  author papers.
%% twocolappendix : make 2 column appendix.
%%   anonymous    : Do not show the authors, affiliations and acknowledgments 
%%                  for dual anonymous review.
%%
%% these can be used in any combination, e.g.
%%
%% \documentclass[twocolumn,linenumbers,trackchanges]{aastex63}
%%
%% AASTeX v6.* now includes \hyperref support. While we have built in specific
%% defaults into the classfile you can manually override them with the
%% \hypersetup command. For example,
%%
%% \hypersetup{linkcolor=red,citecolor=green,filecolor=cyan,urlcolor=magenta}
%%
%% will change the color of the internal links to red, the links to the
%% bibliography to green, the file links to cyan, and the external links to
%% magenta. Additional information on \hyperref options can be found here:
%% https://www.tug.org/applications/hyperref/manual.html#x1-40003
%%
%% Note that in v6.3 "bookmarks" has been changed to "true" in hyperref
%% to improve the accessibility of the compiled pdf file.
%%
%% If you want to create your own macros, you can do so
%% using \newcommand. Your macros should appear before
%% the \begin{document} command.
%%
\newcommand{\vdag}{(v)^\dagger}
\newcommand\aastex{AAS\TeX}
\newcommand\latex{La\TeX}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% The following section defines new commands for comments from co-authors
%%
\definecolor{DarkOrange}{RGB}{204, 85, 0}
\definecolor{LincolnGreen}{RGB}{17, 102, 0}
\def\ion#1#2{#1$\;${\footnotesize\rm{#2}}\relax}

\newcommand{\yy}[1]{{\color{red} yy: {#1}}}
\newcommand{\aam}[1]{{\color{DarkOrange} aam: {#1}}}
\newcommand{\todo}[1]{{\color{magenta} to-do: {#1}}}

\newcommand{\rztf}{$r_\mathrm{ZTF}$}
\newcommand{\gztf}{$g_\mathrm{ZTF}$}
\newcommand{\tfl}{$t_\mathrm{fl}$}
\newcommand{\trise}{$t_\mathrm{rise}$}
\newcommand{\tbmax}{$t_{B,\mathrm{max}}$}
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Reintroduced the \received and \accepted commands from AASTeX v5.2
\received{\today}
% \revised{January 10, 2019}
% \accepted{\today}
%% Command to document which AAS Journal the manuscript was submitted to.
%% Adds "Submitted to " the argument.
\submitjournal{ApJ}

%% For manuscript that include authors in collaborations, AASTeX v6.3
%% builds on the \collaboration command to allow greater freedom to 
%% keep the traditional author+affiliation information but only show
%% subsets. The \collaboration command now must appear AFTER the group
%% of authors in the collaboration and it takes TWO arguments. The last
%% is still the collaboration identifier. The text given in this
%% argument is what will be shown in the manuscript. The first argument
%% is the number of author above the \collaboration command to show with
%% the collaboration text. If there are authors that are not part of any
%% collaboration the \nocollaboration command is used. This command takes
%% one argument which is also the number of authors above to show. A
%% dashed line is shown to indicate no collaboration. This example manuscript
%% shows how these commands work to display specific set of authors 
%% on the front page.
%%
%% For manuscript without any need to use \collaboration the 
%% \AuthorCollaborationLimit command from v6.2 can still be used to 
%% show a subset of authors.
%
%\AuthorCollaborationLimit=2
%
%% will only show Schwarz & Muench on the front page of the manuscript
%% (assuming the \collaboration and \nocollaboration commands are
%% commented out).
%%
%% Note that all of the author will be shown in the published article.
%% This feature is meant to be used prior to acceptance to make the
%% front end of a long author article more manageable. Please do not use
%% this functionality for manuscripts with less than 20 authors. Conversely,
%% please do use this when the number of authors exceeds 40.
%%
%% Use \allauthors at the manuscript end to show the full author list.
%% This command should only be used with \AuthorCollaborationLimit is used.

%% The following command can be used to set the latex table counters.  It
%% is needed in this document because it uses a mix of latex tabular and
%% AASTeX deluxetables.  In general it should not be needed.
%\setcounter{table}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% The following section outlines numerous optional output that
%% can be displayed in the front matter or as running meta-data.
%%
%% If you wish, you may supply running head information, although
%% this information may be modified by the editorial offices.
\shorttitle{The Rise of ZTF SNe Ia}
\shortauthors{Miller et al.}
%%
%% You can add a light gray and diagonal water-mark to the first page 
%% with this command:
\watermark{DRAFT}
%% where "text", e.g. DRAFT, is the text to appear.  If the text is 
%% long you can control the water-mark size with:
%% \setwatermarkfontsize{dimension}
%% where dimension is any recognized LaTeX dimension, e.g. pt, in, etc.
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% This is the end of the preamble.  Indicate the beginning of the
%% manuscript itself with \begin{document}.

\begin{document}

\title{ZTF Early Observations of Type Ia  Supernovae II: \\ First Light, the Initial Rise, and Time to Reach Maximum Brightness}

%% LaTeX will automatically break titles if they run longer than
%% one line. However, you may use \\ to force a line break if
%% you desire. In v6.3 you can include a footnote in the title.

%% A significant change from earlier AASTEX versions is in the structure for 
%% calling author and affiliations. The change was necessary to implement 
%% auto-indexing of affiliations which prior was a manual process that could 
%% easily be tedious in large author manuscripts.
%%
%% The \author command is the same as before except it now takes an optional
%% argument which is the 16 digit ORCID. The syntax is:
%% \author[xxxx-xxxx-xxxx-xxxx]{Author Name}
%%
%% This will hyperlink the author name to the author's ORCID page. Note that
%% during compilation, LaTeX will do some limited checking of the format of
%% the ID to make sure it is valid. If the "orcid-ID.pdf" image file is 
%% present or in the LaTeX pathway, the OrcID icon will appear next to
%% the authors name.
%%
%% Use \affiliation for affiliation information. The old \affil is now aliased
%% to \affiliation. AASTeX v6.3 will automatically index these in the header.
%% When a duplicate is found its index will be the same as its previous entry.
%%
%% Note that \altaffilmark and \altaffiltext have been removed and thus 
%% can not be used to document secondary affiliations. If they are used latex
%% will issue a specific error message and quit. Please use multiple 
%% \affiliation calls for to document more than one affiliation.
%%
%% The new \altaffiliation can be used to indicate some secondary information
%% such as fellowships. This command produces a non-numeric footnote that is
%% set away from the numeric \affiliation footnotes.  NOTE that if an
%% \altaffiliation command is used it must come BEFORE the \affiliation call,
%% right after the \author command, in order to place the footnotes in
%% the proper location.
%%
%% Use \email to set provide email addresses. Each \email will appear on its
%% own line so you can put multiple email address in one \email call. A new
%% \correspondingauthor command is available in V6.3 to identify the
%% corresponding author of the manuscript. It is the author's responsibility
%% to make sure this name is also in the author list.
%%
%% While authors can be grouped inside the same \author and \affiliation
%% commands it is better to have a single author for each. This allows for
%% one to exploit all the new benefits and should make book-keeping easier.
%%
%% If done correctly the peer review system will be able to
%% automatically put the author and affiliation information from the manuscript
%% and save the corresponding author the trouble of entering it by hand.

\correspondingauthor{Adam A. Miller}
\email{amiller@northwestern.edu}

\author[0000-0001-9515-478X]{Adam A. Miller}
\affiliation{Center for Interdisciplinary Exploration and Research in Astrophysics (CIERA) and Department of Physics and Astronomy, Northwestern University, 2145 Sheridan Road, Evanston, IL 60208, USA}
\affiliation{The Adler Planetarium, Chicago, IL 60605, USA}

\author{et al.}


%% Note that the \and command from previous versions of AASTeX is now
%% depreciated in this version as it is no longer necessary. AASTeX 
%% automatically takes care of all commas and "and"s between authors names.

%% AASTeX 6.3 has the new \collaboration and \nocollaboration commands to
%% provide the collaboration status of a group of authors. These commands 
%% can be used either before or after the list of corresponding authors. The
%% argument for \collaboration is the collaboration identifier. Authors are
%% encouraged to surround collaboration identifiers with ()s. The 
%% \nocollaboration command takes no argument and exists to indicate that
%% the nearby authors are not part of surrounding collaborations.

%% Mark off the abstract in the ``abstract'' environment. 
\begin{abstract}

\todo{write the abstract}

\end{abstract}

%% Keywords should appear after the \end{abstract} command. 
%% See the online documentation for the full list of available subject
%% keywords and the rules for their use.
\keywords{surveys}

%% From the front matter, we move on to the body of the paper.
%% Sections are demarcated by \section and \subsection, respectively.
%% Observe the use of the LaTeX \label
%% command after the \subsection to give a symbolic KEY to the
%% subsection for cross-referencing in a \ref command.
%% You can use LaTeX's \ref and \label commands to keep track of
%% cross-references to sections, equations, tables, and figures.
%% That way, if you change the order of any elements, LaTeX will
%% automatically renumber them.
%%
%% We recommend that authors also use the natbib \citep
%% and \citet commands to identify citations.  The citations are
%% tied to the reference list via symbolic KEYs. The KEY corresponds
%% to the KEY in the \bibitem in the reference list below. 

\section{Introduction}

\section{ZTF Photometry}

The sample of 127 SNe Ia utilized in this study was defined in \citet{Yao19},
for the full details on how the sample was created we refer the reader to
that paper. Briefly, the SNe studied herein were discovered in observations
taken for the high-cadence extragalactic experiment conducted by the ZTF
partnership in 2018 \citep{Bellm19a}. This experiment monitors
$\sim$3000\,$\deg^2$ on a nightly basis (over the 9 month period when the
fields are visible), with the aim of obtaining 3 \gztf\ and 3 \rztf\
observations every night. In total, there were 247 spectroscopically
confirmed SNe Ia discovered within these fields. Following cuts to limit the
sample to only those SNe that were discovered ``early'' (defined as 10\,d or
more, in the SN rest frame, prior to the time of maximum light in the
\gztf-band) and have high quality light curves, the sample was reduced to 127
SNe (see \citealt{Yao19} for the full details).

In \citet{Yao19}, we produced ``forced'' point-spread-function (PSF)
photometry for each of the 127 SNe on every image where the SN was observed.
Briefly, the PSF model was generated as part of the ZTF real-time image
subtraction pipeline \citep{Masci19}, which uses an image-differencing
technique based on \citet{Zackay16}. The forced PSF photometry procedure
fixes the position of each SN and measures the PSF flux in all images that
contain the SN position, even in epochs where the SN is not detected (i.e.,
the signal-to-noise ratio [SNR] $\la$1). For this study, we normalize the SN
flux to relative flux measurements by dividing out the peak observed flux in
the \gztf- and \rztf-bands, respectively (peak fluxes were determined using
\texttt{SALT2} \citealt{Guglielmo93}; see \citealt{Yao19} for our
implementation details). The relative fluxes produced via this procedure are
unique for every ZTF reference image (hereafter fcqf\,ID following the
nomenclature in \citealt{Yao19}), as discussed below, we account for these
differences in modeling the SNe in cases where a SN was observed on multiple
fcqf\,IDs in the same filter. In \citet{Yao19} we advocate for the use of
corrective factors $C$, which accounts for a non-zero baseline in the pre-SN
flux measurements, and $\chi^2_{\nu}$, which accounts for underestimated
uncertainties in the flux measurements, when using the results of our forced
photometry. For this study, we ignore the corrections suggested in
\citet{Yao19} and instead incorporate these values into our model so they can
be marginalized over and effectively ignored.

\section{Modeling the Early Rise of SNe Ia}\label{sec:model}

Following arguments first laid out in \citet{Goldhaber98a} and
\citet{Riess99a}, the rest-frame optical flux of a SN Ia should evolve
$\propto t^2$ shortly after explosion. For an ideal, expanding fireball, the
observed flux through a passband covering the Rayleigh-Jeans tail of the
approximately blackbody emission will be $f \propto R^2 T = v^2 t^2 T$, where
$f$ is the SN flux, $T$ is the blackbody temperature, $R$ is photosphere
radius, $v$ is the ejecta velocity, and $t$ is time since explosion. While
these idealized conditions are not perfectly met in nature, $T$ and $v$
clearly change shortly after explosion (e.g., \citealt{Parrent12}), their
relative change is small compared to $t$. Thus, the ``$t^2$-law'' should
approximately hold, and indeed several studies of large samples of SNe Ia
have shown that in the blue optical filters $f \propto t^2$ to within the
uncertainties (e.g., \citealt{Conley06, Hayden10, Ganeshalingam11}). At the
same time, several recent studies of individual, low-redshift SNe Ia show
strong evidence that a power-law model for the SN flux only reproduces the
data if the power-law index, $\alpha$, is significantly lower than 2 (e.g.,
\citealt{Zheng13,Zheng14,Shappee16,Miller18,Fausnaugh19}).

For this study, we characterize the early emission in a single filter from a
SN Ia as a power law:
%
\begin{equation}
    f_b(t) = C + H[t_\mathrm{fl}] A_b (t - t_\mathrm{fl})^{\alpha_b},
    \label{eqn:flux_model}
\end{equation}
%
where $f_b(t)$ is the flux in filter $b$ as a function of time $t$, $C$ is a
constant representing the baseline flux present in the reference image prior
to the SN, $t_\mathrm{fl}$ is the time of first light,\footnote{$t_\mathrm{fl}$ is not the time of
explosion, but rather the time when optical emission begins for the SN, as
the observed emission due to radioactive decay in the interior of the SN
ejecta must first diffuse through the photosphere, see e.g.,
\citet{Piro13,Piro14}.}, $H[t_\mathrm{fl}]$ is the heavyside function equal
to 0 for $t < t_\mathrm{fl}$ and 1 for $t \ge t_\mathrm{fl}$, $A_b$ is a
constant of proportionality in filter $b$, and $\alpha_b$ is the power-law
index describing the rise in filter $b$.

For ZTF, observations are obtained in the \gztf- and \rztf-bands, and, thus
it is possible to model the evolution in both filters simultaneously, as
\tfl\ does not depend upon the choice of filter used to observe the SN. As
discussed in \citet{Yao19}, $C$ depends on the reference co-addition used in
image subtraction, and thus is not strictly a function of filter. Instead,
it is a function of fcqf\,ID, which represents both the filter and ZTF field
ID (see above). The ZTF field grid includes some overlap, and SNe that occur
in overlap regions will have multiple fcqf\,ID for a single filter. These
light curves need to be treated separately in the model fitting, with
independent values of $C$.

If we assume the observed deviations between the model flux and the data are the result of Gaussian scatter, the log-likelihood for the data is:
%
\begin{equation}
    \ln \mathscr{L} = \sum_{d,i} \frac{[f_{d,i} - f_d(t_i)]^2}{(\beta_d \sigma_{d,i})^2},
\end{equation}
%
where the sum is over all fcqf\,ID $d$ and all observations $i$. $f_{d,i}$
is the $i^\mathrm{th}$ flux measurement with corresponding uncertainty
$\sigma_{d,i}$, and $\beta_d$ is a term we add to account for the fact that
the uncertainties are underestimated (see \citealt{Yao19}). Finally,
$f_d(t_i)$ is the model, Equation~\ref{eqn:flux_model} evaluated at the time
of each observation $t_i$, with $C$ replaced by $C_d$, the baseline for the
individual fcqf\,ID, and $A_b$ and $\alpha_b$ replaced by $A_{b\mid d}$ and
$\alpha_{b\mid d}$, respectively, as these terms depend on fcqf\,ID, but
only the filter $b$ and not the field ID.

Ultimately, we only care about 3 model parameters: \tfl, and the power-law
index describing the rise in the \gztf\ and \rztf\ filters, hereafter
$\alpha_g$ and $\alpha_r$, respectively. Following Bayes' Law, we multiply
the likelihood by a prior and use an affine-invariant, ensemble Markov chain
Monte Carlo (MCMC) technique \citep{Goodman10} to approximate the model
posterior. 

There is a strong degeneracy between $A_{b\mid d}$ and $\alpha_{b\mid d}$,
which we find can be removed with the following change of variables
$A^\prime_{b\mid d} = A_{b\mid d} 10^{\alpha_{b\mid d}}$ in
Equation~\ref{eqn:flux_model}. We adopt Jeffreys prior \citep{Jeffreys46} for
the scale invariant parameters $A_{b\mid d}$ and $\beta_d$, and wide flat
priors for all other model parameters, as summarized in
Table~\ref{tab:priors}. The MCMC integration is performed using
\texttt{emcee} \citep{Foreman-Mackey13}. Within the ensemble, we use 100
walkers, each of which is run until convergence or 3 million steps, whichever
comes first. We test for convergence by examining the average autocorrelation
length of the individual chains $\tau$ after every 20,000 steps, and consider
the chains converged if $n_\mathrm{steps} > 100 \,\tau$, where
$n_\mathrm{steps}$ is the total number of steps in each chain, and the change
in $\tau$ relative to the previous estimate has changed by $<1\%$.

\input{./tables/prior.tex}

A key decision in modeling the early evolution of SNe Ia light curves is
deciding what is meant by ``early.'' While the simplistic power-law models
adopted here and elsewhere can describe the flux of SNe Ia shortly after
explosion, it is obvious that these models cannot explain the full evolution
of SNe Ia as they never turn over and decay. Throughout the literature there
are various definitions of early, ranging from some studies defining early
relative to the amount of time that has passed following the epoch of
discovery (e.g., \citealt{Zheng13,Miller18}), to others defining it relative
to the time of $B$-band maximum (e.g., \citealt{Riess99a,Conley06}), while
others define early in terms of the fractional flux relative to maximum light
(e.g., \citealt{Olling15,Firth15,Fausnaugh19}). Here we adopt the latter
definition to be consistent with recent work using extremely high-cadence,
high-precision light curves from the space-based \textit{Kepler} K2
\citep{Howell14} and the Trasiting Exoplanet Survey Satellite (\textit{TESS};
\citealt{Ricker15}) missions (e.g., \citealt{Olling15,Fausnaugh19}). As in
\citet{Olling15}, we only include observations up to 40\% of the peak
amplitude of the SN.\footnote{We do this separately in the \gztf\ and \rztf\
filters. In practice, we subtract a preliminary estimate of the flux baseline
derived from the median flux value for all observations that occured $>20$\,d
(in the SN rest-frame) prior to the time of \gztf\ maximum light. We then
divide all flux values by the peak flux determined in \citet{Yao19}. Finally,
we calculate the inverse-variance weighted mean flux for every night of
observations, and only retain those nights with $f_\mathrm{mean} \le 0.4
f_\mathrm{max}$ for model fitting.} This choice, 40\% instead of 30\% or
50\%, does affect the final inference that is made for individual SNe as
discussed in further detail in \S\ref{sec:systematics}.

Of the 127 SNe Ia in our sample, we find that the MCMC chains converge for
all the SNe but one, ZTF18aaqnrum. Nevertheless, we retain it in our sample
as $n_\mathrm{steps} \approx 81 \,\tau$ after 3 million steps, suggesting
several independent sampels within the chain (it will later be excluded from
the sample, see \S\ref{sec:qa}). From the MCMC chains we can derive
constraints on \tfl, $\alpha_g$, and $\alpha_r$. We show example corner plots
illustrating good, typical, and poor constraints on the model parameters in
Figure~\ref{fig:corner_LC}. In this context good, typical, and poor are
defined relative to the width of the 90\% credible region for \tfl\
($\mathrm{CR}_{90}$). Roughly, the good models have $\mathrm{CR}_{90} \la
1.5$\,d, the median models have $\mathrm{CR}_{90} \approx 2.5$\,d, and the
poor models have $\mathrm{CR}_{90} \ga 4$\,d. From the corner plots it is
clear that there is a positive correlation between $\alpha_g$ and $\alpha_r$,
which makes sense given the relatively similar regions of the spectral energy
distribution traced by these filters. Finally, \tfl\ exhibits significant
covariance with each of the $\alpha$ parameters. While we report marginalized
credible regions on all model parameters below, the full posterior samples
should be used for any analysis utilizing the results of our model fitting. 

\begin{figure*}
    \centering
    \includegraphics[width=5.75in]{./figures/corner_LC.pdf}
    %
    \caption{\textit{Left column}: Corner plots showing the posterior
    constraints on \tfl, $\alpha_g$, $\alpha_r$, and the respective constants
    of proportionality, $A_g$ and $A_r$ for ZTF18abgmcmv (top), a SN that is
    well fit by the model, ZTF18abukmty (middle), a typical SN in our sample,
    and ZTF18aazabmh (bottom), a SN that does not significantly constrain the
    model parameters. For clarity the $C_d$ and $\beta_d$ terms are excluded
    (in general they do not exhibit strong covariance with the parameters
    shown here as they are tightly constrained by the pre-SN observations).
    Marginalized one-dimentional distributions are shown along the diagonal,
    along with the median estimate and the 90\% credible region (shown with
    vertical dashed lines). \textit{Right column}: ZTF light curves of
    ZTF18abgmcmv (top), ZTF18abukmty (middle), and ZTF18aazabmh (bottom)
    showing the \gztf\ (filled, green circles) and \rztf\ (open, red circles)
    evolution of the SN in the month prior to the time of $B$-band maximum
    light (\tbmax). Observations included in the model fitting (i.e., those
    with $f \le 0.4 f_\mathrm{max}$) are dark and solid, while those that are
    not included are faint and semi-transparent. The maximum aposteriori
    model is shown via a thick solid line, while random draws from the
    posterior are shown with semi-transparent dashed lines. The vertical
    dashed line shows the median 1-D marginalized posterior value of \tfl,
    while the thin, light grey vertical line shows \tfl\ for the maximum
    aposteriori model. The bottom panel shows residuals relative to the
    maximum aposteriori model, where the factor $\beta_d$ has been included
    in the calculation of the residuals. \todo{change $t_0$ to \tbmax\ in
    axis label}}
    %
    \label{fig:corner_LC}
\end{figure*}

The light curves used to constrain the model parameters shown in the left
column of Figure~\ref{fig:corner_LC}, are shown in the right column of the
same figure. In addition to the data, we also multiple models based on random
draws from the posterior, and the residuals of the data relative to the
maximum aposteriori estimate from the MCMC sampling. From the top row of
Figure~\ref{fig:corner_LC}, it is clear that in the limit of high SNR, which
typically requires low redshift, and good sampling, it is possible to place
tight constraints on the model parameters. As expected, as the SNR decreases
(middle row) or the typical interval between observations increases (bottom
row), the data eventually reach the point where it is not possible to place
meaninful constraints on \tfl\ or $\alpha$. We visually examine posterior
models for each light curve and flag those that produce unreliable parameter
constraints. We use this subset of sources to identify SNe that should be
excluded from the full sample analysis described in \S\ref{sec:mean_parameters}
below (see Appendix~\ref{sec:qa}). These flagged sources are noted in
Table~\ref{tab:results}.

\section{The Mean Rise Time and Power-Law Index for SNe
Ia\label{sec:mean_parameters}}

Below we examine the results from our model fitting procedure to examine the
typical characteristics of \textit{normal} SNe Ia. We define normal as those
SNe that are suitable for cosmography, which can be
defined as $-2 \la X_1 \la 2$, where $X_1$ is the \texttt{SALT2} shape
parameter. Specifically within the context of our sample, this means we
exclude the SNe classified as SN\,1986G-like, SN\,2002cx-like, Ia-CSM, and
super Chandra explosions in \citet{Yao19} from the analysis below. These
events are specifically addressed in \S\ref{sec:rare}. Following the removal
of these events, 120 SNe remain in the sample.

\subsection{Mean Rise Time of SNe Ia}

From the marginalized 1D posteriors for \tfl, we can examine the typical rise
time for SNe Ia. The model given in Equation~\ref{eqn:flux_model} constrains
\tfl, yet we ultimately care about the rise time \trise. \tfl\ is measured
relative to \tbmax, the time of maximum light in the $B$-band, which itself
has some measurement uncertainty. An estimate of \trise\ must therefore
account for the uncertainties on both \tfl\ and \tbmax. To estimate \trise,
we use a Gaussian kernel density estimation (KDE) to approximate the 1-D
marginalized probability density function (PDF) for \tfl. The width of the
kernel is determined via cross validation and the KDE is implemented with
\texttt{scikit-learn} \citep{Pedregosa11}. The PDF is multiplied by $-1$ and
convolved with a Gaussian with the same variance as the uncertainties on
$t_\mathrm{B,max}$ to determine the final PDF for \trise. The cumulative
density function (CDF) of this PDF is used to determine the median and 90\%
credible region on \trise. There should be no covariance in the uncertainties
on \tfl\ and \tbmax, as these estimates are made using independent methods
and portions of the light curve, which is why we can convolve the
uncertainties in making the final estimation of \trise.

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{./figures/rise_time.pdf}
    %
    \caption{Marginalized posterior distribution of the rise time
    $t_\mathrm{rise}$ for normal SNe Ia in our sample. The sample has been
    divded into three groups (as described in the text): thin grey lines show
    SNe from the unreliable group (see \ref{sec:qa}), dark blue lines show
    SNe from the reliable-$z_\mathrm{SN}$ group, and thick, orange lines show
    SNe reliable-$z_\mathrm{host}$ group. From the individual PDFs it is
    clear that there is no support for a single mean $t_\mathrm{rise}$ to
    describe every SN in the sample.}
    %
    \label{fig:rise_time}
\end{figure}

In Figure~\ref{fig:rise_time} we show the PDF for \trise\ for the 120 normal
SN in our sample. We highlight three subsets of the normal SNe in
Figure~\ref{fig:rise_time}, SNe with reliable model parameters (see~\ref{sec:qa}) and known host galaxy redshifts (hereafter the
reliable-$z_\mathrm{host}$ group), SNe with reliable model parameters and
unknown host galaxy redshifts (hereafter the reliable-$z_\mathrm{SN}$ group),
and SNe with unreliable model parameters (hereafter the unreliable group). 

Figure~\ref{fig:rise_time} shows that \trise\ for SNe in the unreliable group
are biased towards shorter rise times, which serves as additional
confirmation that data are insufficient for constraining the model parameters
for these sources. Figure~\ref{fig:rise_time} also shows that the individual
SNe do not tend towards a single mean value. If all SNe Ia could be described
with a single rise time, we could estimate that mean value by multiplying
together all of the PDFs shown in Figure~\ref{fig:rise_time}. The product of
the individual PDFs provides no support for a single rise time to describe
all SNe Ia (i.e., it is effectively equal to 0 everywhere). Thus, SNe Ia
follow a distribution of rise times, as has previously been reported (e.g.,
\citealt{Riess99a,Ganeshalingam11,Firth15,Zheng17a}).

As a population, SNe Ia have a mean \trise$ \approx 17.4$\,d, where we have
estimated this value by taking a weighted mean of the median value of the
\trise\ PDFs, with weights equal to the square of the inverse of the 68\%
credible region. The mean \trise\ increases to $\approx 18.0$\,d and
$18.3$\,d when considering only the reliable and reliable-$z_\mathrm{host}$
subsamples, respectively. The scatter, estimated via the sample standard
deviation, about these mean values is 1.8\,d, 1.6\,d, and 1.8\,d for the
full, reliable, and reliable-$z_\mathrm{host}$ subsamples, respectively. These estimates differ significantly from previous work in the literature \todo{cite other estimates of the mean rise time...}

\subsection{Mean Power-Law Index of the Early Rise}

We use a similar procedure to report the PDF of $\alpha_g$ and $\alpha_r$
under the assumption of a flat prior. The posterior samples shown in
Figure~\ref{fig:corner_LC} include a factor of $10^{-\alpha}$ following the
change of variables from $A$ to $A^\prime$. To remove this factor, we
estimate the 1-D marginalized PDF of $\alpha$ using a KDE as above. This PDF
is then divided by $10^{-\alpha}$, and then re-normalized to integrate to 1
on the interval from 0 to 10. This final normalized PDF provides an estimate
of $\alpha_g$ and $\alpha_r$ assuming a $\mathcal{U}(0,10)$ prior.

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{./figures/alpha_g.pdf}
    %
    \caption{Marginalized posterior distribution of the rising power-law
    index in the \gztf-band $\alpha_g$ assuming a flat pqrior on $\alpha_g$
    for individual SNe in our sample. The color scheme is the same as in
    Figure~\ref{fig:rise_time}. While the
    density of the PDFs tends towards 2, as would be expected in the simple
    expanding fireball model, there is no support for a single mean power-law
    index to describe all SNe Ia.}
    %
    \label{fig:alpha_rise}
\end{figure}

The PDFs for $\alpha_g$ for normal SN Ia is shown in
Figure~\ref{fig:alpha_rise}. As in Figure~\ref{fig:rise_time}, we have
highlighted 3 subsamples of the data. The tightest constraints on $\alpha_g$
come from the reliable-$z_\mathrm{host}$ group, which are clustered around
$\alpha_g \approx 2$. There are, however, individual SNe within this subgroup
that provide support for $\alpha_g$ as low as $\sim$0.5 and as high as
$\sim$4. The data therefore suggest that $\alpha_g$ can take on a wide range
of values.

The weighted sample mean is $\alpha_g \approx 1.9$ for the normal SNe Ia in
the ZTF sample. This value increases to $\sim$2.1 when reducing the sample to
the reliable group or the reliable-$z_\mathrm{host}$ group. The scatter in the
population is 0.7, 0.5, and 0.6 for the full, reliable, and
reliable-$z_\mathrm{host}$ subsamples, respectively. For $\alpha_r$ the
weighted sample mean is $\sim$1.7 for the full sample of normal SNe Ia, which
increases to $\sim$1.9 and $\sim$2.0 for the reliable and
reliable-$z_\mathrm{host}$ subgroups, respectively. The scatter in $\alpha_r$
is 0.8, 0.5, and 0.5 for the full, reliable, and reliable-$z_\mathrm{host}$
subsamples, respectively. As noted below, there is an extremely tight
correlation between $\alpha_g$ and $\alpha_r$, and thus we do not show the
individual PDFs for $\alpha_r$.

In both the \gztf\ and \rztf\ filters the rising power-law index for the
initial evolution of the SN is remarkably close to 2, as would be expected in
the expanding fireball model. Similar results have been found in other studies
(e.g., \citealt{Conley06,Hayden10,Ganeshalingam11,Zheng17a}), though there are
some studies that have found that $\alpha$ is not consistent with 2
\citep{Firth15}. While the mean value of $\alpha$ is $\approx$2, it is
noteworthy that the PDF for several SNe in the reliable-$z_\mathrm{host}$
sample provide no support for $\alpha = 2$. As was the case for \trise, if we
multiply the individual PDFs of $\alpha_g$ or $\alpha_r$ together we find
there is no support for a single mean value of $\alpha$ capable of explaining
every SN in our sample. This suggests that models using a fixed value of
$\alpha$ are insufficient to explain the full population of normal SNe Ia.

\section{Population correlations}

In addition to looking at the typical values of \trise\ and $\alpha$ for SNe
Ia, we also examine the correlations between these parameters, as well as how
they change with redshift $z$. These correlations may reveal details about the
explosion physics of SNe Ia (for example, if strong mixing in the SN ejecta
leads to low values of $\alpha$, as found in \citealt{Piro16}, then any
correlations with $\alpha$ may be related to ejecta mixing). Alternatively,
these correlations may reveal inadequacies in the model. If the model
parameters are correlated with redshift, that could be evidence for the cosmic
evolution of SNe Ia progenitors.

The correlation between $t_\mathrm{rise}$, $\alpha_g$, $\alpha_r$, and $z$ is
shown in Figure~\ref{fig:model_parameters}. We do not show the correlation
between $\alpha_r$ and $z$ or between $\alpha_g$ and \trise, as this
information is effectively redundant given the tight correlation between
$\alpha_g$ and $\alpha_r$ (top right panel of
Figure~\ref{fig:model_parameters}).

\begin{figure*}
    \centering
    \includegraphics[width=6in]{./figures/param_correlations.pdf}
    %
    \caption{Correlation between redshift $z$, SN rise time
    $t_\mathrm{rise}$, and the power-law index in the \gztf\ and \rztf\
    filters, $\alpha_g$ and $\alpha_r$, respectively. We do not show
    $\alpha_r$ vs.~$z$ or $t_\mathrm{rise}$ vs.~$\alpha_g$, as these would
    largely be redundant given the very strong correlation between $\alpha_g$
    and $\alpha_r$ (upper right panel). The sample has been divded into three
    groups: small, light grey circles show SNe with unreliable fits (see
    \ref{sec:qa}), dark blue circles show reliable fits where the host
    galaxy redshift is not known, and large orange circles show SNe with
    reliable fits with known host galaxy redshifts. The plots show that
    redshift is correlated with both $t_\mathrm{rise}$ and $\alpha_g$, which
    would only be expected is SNe Ia undergo significant evolution from $z
    \approx 0.1$ to $0$. We later show this to be the result of a systematic
    selection effect (see text for further details). }
    %
    \label{fig:model_parameters}
\end{figure*}

\subsection{Correlation Between $\alpha_g$ and $\alpha_r$}

The most striking, and also least surprising, feature in
Figure~\ref{fig:model_parameters} is the tight correlation observed between
$\alpha_g$ and $\alpha_r$. This result is unsurprising because the \gztf\
and \rztf\ filters sample adjacent portions of the SN spectral energy
distribution (SED), and thus the evolution should be nearly identical in the
two filters. SNe with reliable model parameters follow a tight locus around
$\alpha_g - \alpha_r \approx 0.1$, with the only major outliers from this
relation being SNe in the unreliable group (for further discussion of the
early \gztf\ $-$ \rztf\ color evolution of this sample see M.~Bhulla et al.
2019).

The Spearman rank-ordered correlation coefficient \todo{REF} for $\alpha_g$
and $\alpha_r$ is highly significant for the entire population ($\rho >
0.5$), confirming what can clearly be seen by eye. Restricting the sample to
SNe with reliable model parameters increases the significance of the
correlation dramatically ($\rho > 0.9$). Thus, knowledge of the power-lax
index in either filter provides a strong predictor for the power-law index
in the other filter, which, again is not a surprising result.

\subsection{Correlations with Redshift -- Systematics, Not Cosmic Evolution}\label{sec:redshift_correlations}

While less prominent, Figure~\ref{fig:model_parameters} additionally shows
that both \trise\ and $\alpha$ are correlated with redshift. This result is
somewhat surprising: naively, it suggests some form of cosmic evolution in SNe
Ia, with SNe at $z \approx 0.08$ having rise times that are several days
shorter than SNe at $z \approx 0.02$. The small range of redshifts in our
sample, and several previous studies (e.g., \todo{Riess ref on Ia evolution}),
render this naive explanation in doubt. Instead, this correlation can be
understood as the result of building a sample from a flux-limited survey.

Given the fixed depth of ZTF observations ($g_\mathrm{lim} \la 21.5$\,mag;
\citealt{Masci19,Bellm19}), SNe at progressively higher redshifts will be
discovered later and later in their evolution. The large degeneracies in the
model presented in Equation~\ref{eqn:flux_model}, namely between \tfl, $A$,
and $\alpha$, allow for a great deal of flexibility when fitting the data. In
particular, to match the first detection ($\mathrm{SNR} \ga 3$) in the light
curve, it is possible to adjust \tfl\ to successively larger values (i.e.,
shorter rise times), while decreasing $A$ and $\alpha$, such that \tfl\ occurs
around the epoch of first detection. 

We illustrate this behavior in Figure~\ref{fig:high_z_systematic}, which shows
the inferred rise time for four low-$z$ SNe had they been observed at
successively higher redshifts. To simulate these SNe at higher redshift we
make the (over-simplified) assumption that all detections are in the
sky-background dominated regime, and therefore in any given epoch the
$\mathrm{SNR} \propto d_L^{-2}$, where $d_L$ is the luminosity distance to the
SN. Under this assumption, multiplying the uncertainties by the ratio of the
square of the simulated distance to the square of the actual distance provides
the SNR for the SN at the simulated redshift.\footnote{Following
\citet{Yao19}, we adopt a flat $\Lambda$CDM cosmology with $H_0 =
73.24$\,km\,s$^{-1}$\,Mpc$^{-1}$ \citep{Riess16} and $\Omega_m = 0.275$
\citep{Amanullah10} to calculate $d_L$ for the SNe.} Using these increased
uncertainties, we randomly resample the observed flux values from a normal
distribution with mean equal to the original flux and variance equal to the
scaled uncertainty squared. This resampling is necessary, as the $\beta_d$
term in Equation~\ref{eqn:flux_model} would otherwise reverse the increase in
the uncertainties when maximizing the posterior. We then fit the noisier
simulated data with the same procedure described in Section~\ref{sec:model}.
This procedure is repeated at redshifts of $z = 0.05$, 0.075, 0.1, and 0.015.
Only the models that converge are shown in Figure~\ref{fig:high_z_systematic}.

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{./figures/high_z_systematic.pdf}
    %
    \caption{Same as the bottom left panel of
    Figure~\ref{fig:model_parameters}, though all SNe are shown in grey. The
    large green circle, magenta diamond, orange triangle, and purple $X$ show
    how marginalized posterior estimates of \trise\ change as the four lowest
    redshift SNe are observed at $z = 0.05$, 0.075, 0.1, and 0.015 (see text
    for further details). \trise\ clearly decreases with increasing redshift,
    showing that the observed correlation between these parameters is due to
    the flux-limited ZTF search for SNe, and not cosmic evolution.}
    %
    \label{fig:high_z_systematic}
\end{figure}

The results of this simulation are clear: as the SN redshift increases, the
rise time correspondingly decreases. This result is simple to understand as
higher redshift SNe will not be detected until later in their evolution. A
stronger prior on any of the model parameters would help to combat this
effect, though as previously discussed we avoid strong priors due to the wide
range of $\alpha$ and \tfl\ that has been reported in the literature. This
effect also explains the correlation seen in the bottom right panel of
Figure~\ref{fig:model_parameters}. SNe detected later in their evolution will
be evolving less rapidly as the rate of change in brightness continually
decreases until the time of maximum light. Hence, a later detection provides a
lower value of $\alpha$. Indeed, a re-creation of
Figure~\ref{fig:high_z_systematic} showing $\alpha_g$ instead of \trise\ shows
$\alpha_g$ decreasing with increasing redshift. Thus, the observed
correlations with redshift seen in Figure~\ref{fig:model_parameters} can be
entirely understood as the result of ZTF being a flux-limited survey.

The implications of this result have consequences well beyond the ZTF sample
discussed here. Essentially all SN surveys are flux-limited, meaning the
systematics associated with redshift will affect any efforts to determine
\trise\ or $\alpha$ in those data as well. The inclusion of higher-redshift
SNe in the sample will, on average, bias estimates of \trise\ and $\alpha$ to
lower values. Even more concerning is the possibility that this trend may
continue to very low redshifts ($z \ll 0.01$). The paucity of SNe in this
redshift range, due to the relatively small volume probed, make it difficult
to test for such an effect. Due to the systematic identified here, it may be
the case that the rise time, and by extension also $\alpha$, are
underestimated for every SN in the literature. Detailed simulations with
realistic SN light curves are needed to test this posibility.
\todo{Need to make sure this paragraph  is properly emphasized}

\subsection{Correlations with Light Curve Shape}

A defining characteristic of SNe Ia is that they can be described by a
relatively simple luminosity-shape relation \citep{Phillips93}, which enables
them to be used as standardizable candles. We examine the correlation between
light curve shape, in this case the \texttt{SALT2} $X_1$ parameter, and the SN
rise time and $\alpha$ in Figure~\ref{fig:shape_correlations}. There is a
clear correlation between shape and \trise, a result that has been reported
previously (e.g., \citealt{Riess99a,Firth15,Zheng17a}). This result is also
completely unsurprising as the $X_1$ shape parameter accounts for the width of
both the SN rise and decline, and therefore, by definition should be
correlated with the rise time.

\begin{figure*}
    \centering
    \includegraphics[width=1\linewidth]{./figures/shape_correlations.pdf}
    %
    \caption{Correlation between the \texttt{SALT2} $X_1$ shape parameter and
    $\alpha_g$ (top row) and \trise\ (bottom row). Symbols are the same as
    Figure~\ref{fig:model_parameters}. \trise\ shows a strong correlation with
    $X_1$, while there is no correlation between $\alpha_g$ and $X_1$. The
    second, third, and fourth columns highlight reliable-$z_\mathrm{host}$ SNe
    with redshifts $z \le 0.04$, $0.04 < z \le 0.065$, and $z > 0.065$,
    respectively. Dividing the sample into different redshift bins shows that
    most of the observed scatter between $X_1$ and the model parameters is due
    to redshift and not intrinsic scatter. }
    %
    \label{fig:shape_correlations}
\end{figure*}

This observed correlation does stand in contrast to what was found in
\citet{Hayden10}, where the slowest declining SNe are among the fastest
risers, and a few fast-declining SNe have long rise times. This particular
result may be understood in the context described in
\S\ref{sec:redshift_correlations}. Slowly declining SNe are more luminous, and
therefore will, on average, be found at higher redshifts than rapidly
declining events in a flux limited survey. As
Figure~\ref{fig:high_z_systematic} shows, for SNe all discovered by the same
survey, the rise times are underestimated for higher redshift events. Indeed,
such an effect is seen in the ZTF sample, as illustrated in the 3 right
columns of Figure~\ref{fig:shape_correlations}. If the
reliable-$z_\mathrm{host}$ subsample is divided in redshift bins, it is clear
that, at fixed values of $X_1$, the corresponding value of \trise\ decreases
as the redshift increases. This bolsters the arguments in
\S\ref{sec:redshift_correlations} that there is a systematic error in the
estimate of \trise\ due to redshift, and means that the intrinsic scatter in
the relation between $X_1$ and \trise\ is much smaller than the observed
scatter seen in Figure~\ref{fig:shape_correlations}.

There is no strong correlation between $\alpha$ and $X_1$. The Spearman
rank-ordered correlation for these two parameters is $\rho \approx -0.2$
whether looking at $\alpha_g$ or $\alpha_r$, or whether considering the full
sample, the reliable group, or the reliable-$z_\mathrm{host}$ group.
Subdividing the reliable-$z_\mathrm{host}$ group by redshift shows the same
trend that was identified in Figure~\ref{fig:model_parameters}: higher
redshift SNe have smaller values of $\alpha$ on average for the
reliable-$z_\mathrm{host}$ group.

\section{Strong Priors}\label{sec:strong_priors}

In our previous effort to model the early evolution of SNe Ia we adopted a
flexible model allowing $\alpha$ and \tfl\ to simultaneously vary despite
theoretical \citep{Arnett82,Riess99a} and observational
\citep{Conley06,Hayden10,Ganeshalingam11} evidence that $\alpha = 2$. Here we
alter the model by fixing $\alpha_g = \alpha_r = 2$ (hereafter the
``$\alpha = 2$ prior''), and explore how this decision changes the results
described in the previous sections. This decision is equivalent to placing an
infinitely strong prior on the value of $\alpha$.\footnote{There is some
empirical evidence that the power-law index decreases when moving from the
blue to the red portion of the SN SED \citep{Shappee16,Zheng17}. The same
trend is seen in this study (top right panel of
Figure~\ref{fig:model_parameters}). Thus, strictly enforcing $\alpha_g =
\alpha_r$ may impose non-physical structure in the models.}

The distribution of rise time PDFs using the $\alpha = 2$ prior is shown in Figure~\ref{fig:tsquared_rise}. As previously noted, the use of a strict prior significantly reduces the flexibility of the model. As a result, there are far fewer SNe with model parameters that can immediately be considered unreliable. When using the $\alpha = 2$ prior, we only flag SNe with an extrapolated flux using the maximum aposteriori model parameters $< 0.9 f_\mathrm{max}$ at \tbmax\ as having unreliable model parameters. Using this criterion we find \todo{add number of reliable SNe} SNe have unreliable model parameters. 

\begin{figure}
    \centering
    \includegraphics[width=1\linewidth]{./figures/tsquared_rise_time.pdf}
    %
    \caption{Same as Figure~\ref{fig:rise_time}, showing the resulting PDFs
    for the $\alpha = 2$ prior. As was the case when $\alpha$ is allowed to
    vary, there is no support for a single mean $t_\mathrm{rise}$ to describe
    every SN in the sample. The $\alpha = 2$ prior results in rise times that
    are $\sim$2\,d longer on average.}
    %
    \label{fig:tsquared_rise}
\end{figure}

\acknowledgements

Dan F-M? Will Farr?

\software{
         % \texttt{astropy} \citep{Astropy-Collaboration13},
          \texttt{scipy} \citep{Jones01}, 
          \texttt{matplotlib} \citep{Hunter07},
          \texttt{pandas} \citep{McKinney10},
          \texttt{emcee} \citep{Foreman-Mackey13},
          \texttt{corner} \citep{Foreman-Mackey16}
          }

%% For this sample we use BibTeX plus aasjournals.bst to generate the
%% the bibliography. The sample63.bib file was populated from ADS. To
%% get the citations to show in the compiled file do the following:
%%
%% pdflatex sample63.tex
%% bibtext sample63
%% pdflatex sample63.tex
%% pdflatex sample63.tex

\appendix

\section{Quality Assurance \label{sec:qa}}

As noted in \S\ref{sec:model}, the MCMC model converges for all but one ZTF
SNe within the sample. However, visual inspection of both the corner plots and
individual draws from the posterior quickly reveals that for some SNe the data
do not provide strong constraints on the model parameters (see the bottom row
of Figure~\ref{fig:corner_LC}). In the most extreme cases, as shown in
Figure~\ref{fig:biggap_lc}, large gaps in the observations make it nearly
impossible to constrain the model parameters. For these cases, the model
posteriors are essentially identical to the priors (there is always a weak
constraint on \tfl\ from epochs where the SN is not detected).

\begin{figure}
    \centering
    \includegraphics[width=3.4in]{./figures/ZTF18aaqffyp_model_lc.pdf}
    %
    \caption{Same as Figure~\ref{fig:corner_LC} for ZTF18aaqffyp, a SN with
    observations that place very weak constraints on \tfl. The marginalized
    posteriors for $A^\prime$ and $\alpha$ are essentially identical to the
    priors. Posteriors with little information beyond the prior are typical
    of SNe with significant observational gaps.}
    %
    \label{fig:biggap_lc}
\end{figure}

To identify SNe with poor observational coverage, or unusual structure in the
posterior, we visually examine the light curves and corner plots for each of
the 127 SNe in our sample. We flag SNe where the model significantly
underestimates the flux near \tbmax\ (similar to what is shown in
Figure~\ref{fig:biggap_lc}), as this is a good indicator that the model has
poor predictive value. By definition the light curve derivative is zero at
maximum light, and the relative change in brightness constantly slows down in
the $\sim$week leading up to maximum light. Therefore, models of the early
emission should greatly over-predict the flux at maximum, which is why we
adopt this criterion for flagging SNe with poorly constrained model
parameters.

Numerically, the visually flagged SNe can, for the most part, be identified
by a combination of two criteria: the 90\% credible region on \tfl,
$\mathrm{CR}_{90}$, and the number of nights on which the SN was detected.
Rather than providing a threshold for detection (e.g., $3\sigma$, $5\sigma$,
etc.), we count all nights with $f_\mathrm{mean} \le 0.4 f_\mathrm{max}$
after the median marginalized posterior value of \tfl\ with observations in
either the \gztf, \rztf, or both filters, $N_{g, \mathrm{det}}$, $N_{r,
\mathrm{det}}$, and $N_{gr, \mathrm{det}}$, respectively. We take the
geometric mean of these three numbers to derive the ``average'' number of
nights on which the SN was detected, $\mathrm{GM}(N_\mathrm{det})$. A scatter
plot showing $\mathrm{GM}(N_\mathrm{det})$ vs.\ $\mathrm{CR}_{90}$ is shown
in Figure~\ref{fig:flagged_sn}. Visually flagged SNe are shown as orange
circles, while $+$ symbols show those that were not flagged.

\begin{figure*}
    \centering
    \includegraphics[width=5in]{./figures/final_sample.pdf}
    %
    \caption{Scatter plot showing the distribution of the 127 ZTF SNe Ia in
    the $\mathrm{GM}(N_\mathrm{det})$--$\mathrm{CR}_{90}$ plane. Models with
    flagged posterior parameters are shown as orange circles, while those
    that are not flagged are shown via $+$ symbols. The dashed line shows the
    adopted separation threshold for identifying reliable model fits (above
    the line), and unreliable model fits. FP and FN (see text) SNe are
    circled. }
    %
    \label{fig:flagged_sn}
\end{figure*}

The visual inspection procedure described above is not fully reproducible
(visual inspection is by its very nature subjective). Therefore, we aim to
separate the SNe into two classes (reliable and unreliable) via an automated,
systematic procedure. Treating the visually flagged sources as the negative
class, we view false positives (i.e., visually flagged SNe that are included
in the final population analysis) particularly harmful. Therefore, we adopt
%
$$ \mathrm{GM}(N_\mathrm{det}) \ge 1.9\,\mathrm{CR}_{90} + 1.65,$$
%
as the classification threshold for reliable model fits (as shown via the
dashed line in Figure~\ref{fig:flagged_sn}). This threshold retains 50 true
positives (TP; visually good models included in the final sample) with only a
single false positive (FP; visually flagged SNe in the final sample). This
choice does result in 20 false negatives (FN; visually good models
\textit{excluded} from the final sample), while all remaining flagged SNe are
true negatives (TN). Further scrutiny of the FN reveals several light curves
with significant observational gaps, which, as discussed above, makes it
difficult to place strong constraints on the model parameters. Ultimately,
our two-step procedure identifies 51 SNe as reliable, while 76 are excluded
from the final population analysis due to their unreliable constraints on the
model parameters.

\section{Systematics\label{sec:systematics}}


\bibliography{/Users/adamamiller/Documents/tex_stuff/papers}
\bibliographystyle{aasjournal}

%% This command is needed to show the entire author+affiliation list when
%% the collaboration and author truncation commands are used.  It has to
%% go at the end of the manuscript.
%\allauthors

%% Include this line if you are using the \added, \replaced, \deleted
%% commands to see a summary list of all changes at the end of the article.
%\listofchanges

\end{document}

% End of file `sample63.tex'.
